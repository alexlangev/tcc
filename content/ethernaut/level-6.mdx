---
title: Level 6 - Delegation
slug: level-6
published: 05-16-2023
lastEdited:
---

## Objectives

1. Claim ownership of the contract.

## Vulnerabilities

### Delegate call

You can use a `delegatecall` to an address to execute logic from the address in the context of the
caller's state.

## Exploit

1. Evaluate the function signature of `pwn()`. I used `web3.eth.abi.encodeFunctionSignature("pwn()")`
   directly in console on ethernaut's website.

2. Call the Delegation contract with `pwn`'s function signature as data. Remix's interface works well
   for this.

## Suggested mitigation

1. Remove the body from the `fallback` function since it does nothing except creating a vulnerability.

## Further reading

- SWC-112 - Delegatecall to untrusted callee <EternalLink href={"https://swcregistry.io/docs/SWC-112"} />
- Parity wallet hack <ExternalLink href={"https://blog.openzeppelin.com/on-the-parity-wallet-multisig-hack-405a8c12e8f7/"} />
