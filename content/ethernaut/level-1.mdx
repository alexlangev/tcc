---
title: Level 1 - Fallback
slug: level-1
published: 05-15-2023
lastEdited:
imgSrc: /images/ethernaut/ethernaut1.svg
---

## Objectives

1. Claim ownership of the contract.
2. Steal all of the funds.

## Vulnerabilities

### Flawed access control

`receive` is a public function that transfers the ownership to `msg.sender`. The condition of `require` is also not very strict.
This **opens the door for anyone to become the owner**.

```solidity
receive() external payable {
  require(msg.value > 0 && contributions[msg.sender] > 0);
  owner = msg.sender;
}
```

## Exploit

1. Call `contribute` alongside a value of at least 1 Wei. This will make the _balance of your address positive_.
2. Send at least 1 Wei to the contract address. The `receive` function will then execute. Since the _balance of your address is greater than 0_,
   the `require` condition is met. **You are now the owner of the contract**.
3. Call `withdraw` to **steal all of the funds**.

## Suggested mitigation

- Move the ownership assignment behavior into a function with a `onlyOwner` modifier.
- For bigger projects, use the `Ownable` library by OpenZeppelin.

## Further reading

- **Ownership** by OpenZeppelin <ExternalLink href={"https://docs.openzeppelin.com/contracts/2.x/api/ownership"} />
- A short blog post on ownership exploits <ExternalLink href={"https://blog.finxter.com/smart-contract-security-series-part-1-ownership-exploit/"} />
